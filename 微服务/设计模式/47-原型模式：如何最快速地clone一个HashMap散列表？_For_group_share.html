<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>47-åŸå‹æ¨¡å¼ï¼šå¦‚ä½•æœ€å¿«é€Ÿåœ°cloneä¸€ä¸ªHashMapæ•£åˆ—è¡¨ï¼Ÿ</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <style>
        html {
            color: #333;
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
            text-rendering: optimizelegibility;
            font-family: Helvetica Neue, PingFang SC, Verdana, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, sans-serif
        }

        html.borderbox *,
        html.borderbox :after,
        html.borderbox :before {
            box-sizing: border-box
        }

        article,
        aside,
        blockquote,
        body,
        button,
        code,
        dd,
        details,
        dl,
        dt,
        fieldset,
        figcaption,
        figure,
        footer,
        form,
        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        header,
        hr,
        input,
        legend,
        li,
        menu,
        nav,
        ol,
        p,
        pre,
        section,
        td,
        textarea,
        th,
        ul {
            margin: 0;
            padding: 0
        }

        article,
        aside,
        details,
        figcaption,
        figure,
        footer,
        header,
        menu,
        nav,
        section {
            display: block
        }

        audio,
        canvas,
        video {
            display: inline-block
        }

        body,
        button,
        input,
        select,
        textarea {
            font: 300 1em/1.8 PingFang SC, Lantinghei SC, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, Helvetica, sans-serif
        }

        button::-moz-focus-inner,
        input::-moz-focus-inner {
            padding: 0;
            border: 0
        }

        table {
            border-collapse: collapse;
            border-spacing: 0
        }

        fieldset,
        img {
            border: 0
        }

        blockquote {
            position: relative;
            color: #999;
            font-weight: 400;
            border-left: 1px solid #1abc9c;
            padding-left: 1em;
            margin: 1em 3em 1em 2em
        }

        @media only screen and (max-width: 640px) {
            blockquote {
                margin: 1em 0
            }
        }

        abbr,
        acronym {
            border-bottom: 1px dotted;
            font-variant: normal
        }

        abbr {
            cursor: help
        }

        del {
            text-decoration: line-through
        }

        address,
        caption,
        cite,
        code,
        dfn,
        em,
        th,
        var {
            font-style: normal;
            font-weight: 400
        }

        ol,
        ul {
            list-style: none
        }

        caption,
        th {
            text-align: left
        }

        q:after,
        q:before {
            content: ""
        }

        sub,
        sup {
            font-size: 75%;
            line-height: 0;
            position: relative
        }

        :root sub,
        :root sup {
            vertical-align: baseline
        }

        sup {
            top: -.5em
        }

        sub {
            bottom: -.25em
        }

        a {
            color: #1abc9c
        }

        a:hover {
            text-decoration: underline
        }

        .typo a {
            border-bottom: 1px solid #1abc9c
        }

        .typo a:hover {
            border-bottom-color: #555;
            color: #555
        }

        .typo a:hover,
        a,
        ins {
            text-decoration: none
        }

        .typo-u,
        u {
            text-decoration: underline
        }

        mark {
            background: #fffdd1;
            border-bottom: 1px solid #ffedce;
            padding: 2px;
            margin: 0 5px
        }

        code,
        pre,
        pre tt {
            font-family: Courier, Courier New, monospace
        }

        pre {
            background: hsla(0, 0%, 97%, .7);
            border: 1px solid #ddd;
            padding: 1em 1.5em;
            display: block;
            -webkit-overflow-scrolling: touch
        }

        hr {
            border: none;
            border-bottom: 1px solid #cfcfcf;
            margin-bottom: .8em;
            height: 10px
        }

        .typo-small,
        figcaption,
        small {
            font-size: .9em;
            color: #888
        }

        b,
        strong {
            font-weight: 700;
            color: #000
        }

        [draggable] {
            cursor: move
        }

        .clearfix:after,
        .clearfix:before {
            content: "";
            display: table
        }

        .clearfix:after {
            clear: both
        }

        .clearfix {
            zoom: 1
        }

        .textwrap,
        .textwrap td,
        .textwrap th {
            word-wrap: break-word;
            word-break: break-all
        }

        .textwrap-table {
            table-layout: fixed
        }

        .serif {
            font-family: Palatino, Optima, Georgia, serif
        }

        .typo-dl,
        .typo-form,
        .typo-hr,
        .typo-ol,
        .typo-p,
        .typo-pre,
        .typo-table,
        .typo-ul,
        .typo dl,
        .typo form,
        .typo hr,
        .typo ol,
        .typo p,
        .typo pre,
        .typo table,
        .typo ul,
        blockquote {
            margin-bottom: 1rem
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: PingFang SC, Helvetica Neue, Verdana, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, sans-serif;
            color: #000;
            line-height: 1.35
        }

        .typo-h1,
        .typo-h2,
        .typo-h3,
        .typo-h4,
        .typo-h5,
        .typo-h6,
        .typo h1,
        .typo h2,
        .typo h3,
        .typo h4,
        .typo h5,
        .typo h6 {
            margin-top: 1.2em;
            margin-bottom: .6em;
            line-height: 1.35
        }

        .typo-h1,
        .typo h1 {
            font-size: 2em
        }

        .typo-h2,
        .typo h2 {
            font-size: 1.8em
        }

        .typo-h3,
        .typo h3 {
            font-size: 1.6em
        }

        .typo-h4,
        .typo h4 {
            font-size: 1.4em
        }

        .typo-h5,
        .typo-h6,
        .typo h5,
        .typo h6 {
            font-size: 1.2em
        }

        .typo-ul,
        .typo ul {
            margin-left: 1.3em;
            list-style: disc
        }

        .typo-ol,
        .typo ol {
            list-style: decimal;
            margin-left: 1.9em
        }

        .typo-ol ol,
        .typo-ol ul,
        .typo-ul ol,
        .typo-ul ul,
        .typo li ol,
        .typo li ul {
            margin-bottom: .8em;
            margin-left: 2em
        }

        .typo-ol ul,
        .typo-ul ul,
        .typo li ul {
            list-style: circle
        }

        .typo-table td,
        .typo-table th,
        .typo table caption,
        .typo table td,
        .typo table th {
            border: 1px solid #ddd;
            padding: .5em 1em;
            color: #666
        }

        .typo-table th,
        .typo table th {
            background: #fbfbfb
        }

        .typo-table thead th,
        .typo table thead th {
            background: hsla(0, 0%, 95%, .7)
        }

        .typo table caption {
            border-bottom: none
        }

        .typo-input,
        .typo-textarea {
            -webkit-appearance: none;
            border-radius: 0
        }

        .typo-em,
        .typo em,
        caption,
        legend {
            color: #000;
            font-weight: inherit
        }

        .typo-em {
            position: relative
        }

        .typo-em:after {
            position: absolute;
            top: .65em;
            left: 0;
            width: 100%;
            overflow: hidden;
            white-space: nowrap;
            content: "\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB"
        }

        .typo img {
            max-width: 100%
        }

        .common-content {
            font-weight: 400;
            color: #353535;
            line-height: 1.75rem;
            white-space: normal;
            word-break: normal;
            font-size: 1rem
        }

        .common-content img {
            display: block;
            max-width: 100%;
            background-color: #eee
        }

        .common-content audio,
        .common-content video {
            width: 100%;
            background-color: #eee
        }

        .common-content center,
        .common-content font {
            margin-top: 1rem;
            display: inline-block
        }

        .common-content center {
            width: 100%
        }

        .common-content pre {
            margin-top: 1rem;
            padding-left: 0;
            padding-right: 0;
            position: relative;
            overflow: hidden
        }

        .common-content pre code {
            font-size: .8rem;
            font-family: Consolas, Liberation Mono, Menlo, monospace, Courier;
            display: block;
            width: 100%;
            box-sizing: border-box;
            padding-left: 1rem;
            padding-right: 1rem;
            overflow-x: auto
        }

        .common-content hr {
            border: none;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            border-top: 1px solid #f5f5f5;
            height: 1px;
            background: none
        }

        .common-content b,
        .common-content h1,
        .common-content h2,
        .common-content h3,
        .common-content h4,
        .common-content h5,
        .common-content strong {
            font-weight: 700
        }

        .common-content h1,
        .common-content h2 {
            font-size: 1.125rem;
            margin-bottom: .45rem
        }

        .common-content h3,
        .common-content h4,
        .common-content h5 {
            font-size: 1rem;
            margin-bottom: .45rem
        }

        .common-content p {
            font-weight: 400;
            color: #353535;
            margin-top: .15rem
        }

        .common-content .orange {
            color: #ff5a05
        }

        .common-content .reference {
            font-size: 1rem;
            color: #888
        }

        .custom-rich-content h1 {
            margin-top: 0;
            font-weight: 400;
            font-size: 15.25px;
            border-bottom: 1px solid #eee;
            line-height: 2.8
        }

        .custom-rich-content li,
        .custom-rich-content p {
            font-size: 14px;
            color: #888;
            line-height: 1.6
        }

        table.hljs-ln {
            margin-bottom: 0;
            border-spacing: 0;
            border-collapse: collapse
        }

        table.hljs-ln,
        table.hljs-ln tbody,
        table.hljs-ln td,
        table.hljs-ln tr {
            box-sizing: border-box
        }

        table.hljs-ln td {
            padding: 0;
            border: 0
        }

        table.hljs-ln td.hljs-ln-numbers {
            min-width: 15px;
            color: rgba(27, 31, 35, .3);
            text-align: right;
            white-space: nowrap;
            cursor: pointer;
            user-select: none
        }

        table.hljs-ln td.hljs-ln-code,
        table.hljs-ln td.hljs-ln-numbers {
            font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, Courier, monospace;
            font-size: 12px;
            line-height: 20px;
            vertical-align: top
        }

        table.hljs-ln td.hljs-ln-code {
            position: relative;
            padding-right: 10px;
            padding-left: 10px;
            overflow: visible;
            color: #24292e;
            word-wrap: normal;
            white-space: pre
        }

        video::-webkit-media-controls {
            overflow: hidden !important
        }

        video::-webkit-media-controls-enclosure {
            width: calc(100% + 32px);
            margin-left: auto
        }

        ._29HP61GA_0 {
            max-width:800px;
            margin:0 auto;
            margin-bottom: 20px;
            font-weight: 400;
            color: #353535;
            line-height: 1.76;
            white-space: normal;
            word-break: normal;
            font-size: 17px;
            -webkit-transition: background-color .3s ease;
            transition: background-color .3s ease
        }

        ._29HP61GA_0 .MathJax_Display {
            overflow: auto
        }

        ._29HP61GA_0 .poster {
            position: fixed;
            left: -10000px;
            top: -10000px;
            overflow: hidden;
            padding: 1rem;
            background: #ececec
        }

        ._29HP61GA_0 .richcontent-pre-copy {
            font-size: 13px;
            color: #888;
            position: absolute;
            right: 1em;
            top: .5em;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none
        }

        ._29HP61GA_0 .richcontent-pre-copy .iconfont {
            font-size: 12px;
            margin-right: .2em
        }

        ._29HP61GA_0 a {
            color: #fa8919;
            border-bottom: 1px solid #fa8919
        }

        ._29HP61GA_0 img {
            display: block;
            max-width: 100%;
            position: relative;
            left: 50%;
            -webkit-transform: translateX(-50%);
            transform: translateX(-50%);
            background-color: #eee;
            vertical-align: top;
            border-radius: 0
        }

        ._29HP61GA_0 audio,
        ._29HP61GA_0 video {
            width: 100%;
            background-color: #eee
        }

        ._29HP61GA_0 pre {
            margin-top: 16px;
            padding: 34px 0 0;
            margin-bottom: 30px;
            position: relative;
            border-radius: 6px;
            background: rgba(246, 247, 251, .749);
            border: 0
        }

        ._29HP61GA_0 pre code {
            font-size: 12px;
            font-family: Consolas, Liberation Mono, Menlo, monospace, Courier;
            display: block;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
            margin-left: 16px;
            margin-right: 16px;
            overflow-x: scroll
        }

        ._29HP61GA_0 pre code:after {
            content: "";
            height: 30px;
            width: 100%;
            display: block
        }

        ._29HP61GA_0 hr {
            border: none;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            border-top: 1px solid #f5f5f5;
            height: 1px;
            background: none
        }

        ._29HP61GA_0 h1,
        ._29HP61GA_0 h2,
        ._29HP61GA_0 h3,
        ._29HP61GA_0 h4,
        ._29HP61GA_0 h5 {
            margin-bottom: 20px;
            margin-top: 0;
            font-weight: 700
        }

        ._29HP61GA_0 b,
        ._29HP61GA_0 strong {
            font-weight: 700
        }

        ._29HP61GA_0 h1 {
            font-size: 21px
        }

        ._29HP61GA_0 h2 {
            font-size: 20px
        }

        ._29HP61GA_0 h3 {
            font-size: 19px
        }

        ._29HP61GA_0 h4 {
            font-size: 18px
        }

        ._29HP61GA_0 h5 {
            font-size: 17px
        }

        ._29HP61GA_0 center,
        ._29HP61GA_0 p {
            font-weight: 400;
            color: #353535;
            margin-top: 0;
            margin-bottom: 30px;
            word-break: break-word
        }

        ._29HP61GA_0 center {
            text-align: center
        }

        ._29HP61GA_0 blockquote {
            margin-top: 0;
            margin-bottom: 34px;
            border-left: 3px solid #e8e8e8;
            padding-left: 17px;
            color: #353535
        }

        ._29HP61GA_0 blockquote p {
            margin-top: 0;
            margin-bottom: 0
        }

        ._29HP61GA_0 ol,
        ._29HP61GA_0 ul {
            margin-bottom: 30px
        }

        ._29HP61GA_0 ol p,
        ._29HP61GA_0 ul p {
            margin-top: 0;
            margin-bottom: 0
        }

        ._29HP61GA_0 ol {
            list-style: decimal;
            margin-left: 20px
        }

        ._29HP61GA_0 ul li {
            padding-left: 17px;
            position: relative;
            margin-bottom: 10px
        }

        ._29HP61GA_0 ul li:after {
            content: "";
            height: 6px;
            width: 6px;
            border-radius: 50%;
            background: #353535;
            position: absolute;
            top: 10px;
            left: 0
        }

        ._29HP61GA_0 .orange {
            color: #fa8919
        }

        ._29HP61GA_0 .reference {
            color: #888
        }

        ._29HP61GA_0 .m-right {
            text-align: right
        }

        ._29HP61GA_0 .m-center {
            text-align: center;
            display: block
        }

        ._29HP61GA_0 .m-gray {
            color: #888
        }

        ._29HP61GA_0 .m-small {
            font-size: 15px
        }

        ._29HP61GA_0 table.hljs-ln {
            margin-bottom: 0;
            border-spacing: 0;
            border-collapse: collapse
        }

        ._29HP61GA_0 table.hljs-ln,
        ._29HP61GA_0 table.hljs-ln tbody,
        ._29HP61GA_0 table.hljs-ln td,
        ._29HP61GA_0 table.hljs-ln tr {
            -webkit-box-sizing: border-box;
            box-sizing: border-box
        }

        ._29HP61GA_0 table.hljs-ln td {
            padding: 0;
            border: 0
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-numbers {
            min-width: 15px;
            font-size: 12px;
            color: rgba(27, 31, 35, .3);
            text-align: right;
            white-space: nowrap;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-code,
        ._29HP61GA_0 table.hljs-ln td.hljs-ln-numbers {
            font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, Courier, monospace;
            line-height: 20px;
            vertical-align: top
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-code {
            position: relative;
            padding-right: 10px;
            padding-left: 10px;
            overflow: visible;
            font-size: 13px;
            color: #666;
            word-wrap: normal;
            white-space: pre
        }

    </style>
</head>
<body>
<div class="_29HP61GA_0">
<h1>47-åŸå‹æ¨¡å¼ï¼šå¦‚ä½•æœ€å¿«é€Ÿåœ°cloneä¸€ä¸ªHashMapæ•£åˆ—è¡¨ï¼Ÿ</h1>
<p>å¯¹äºåˆ›å»ºå‹æ¨¡å¼ï¼Œå‰é¢æˆ‘ä»¬å·²ç»è®²äº†å•ä¾‹æ¨¡å¼ã€å·¥å‚æ¨¡å¼ã€å»ºé€ è€…æ¨¡å¼ï¼Œä»Šå¤©æˆ‘ä»¬æ¥è®²æœ€åä¸€ä¸ªï¼šåŸå‹æ¨¡å¼ã€‚</p><p>å¯¹äºç†Ÿæ‚‰JavaScriptè¯­è¨€çš„å‰ç«¯ç¨‹åºå‘˜æ¥è¯´ï¼ŒåŸå‹æ¨¡å¼æ˜¯ä¸€ç§æ¯”è¾ƒå¸¸ç”¨çš„å¼€å‘æ¨¡å¼ã€‚è¿™æ˜¯å› ä¸ºï¼Œæœ‰åˆ«äºJavaã€C++ç­‰åŸºäºç±»çš„é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ï¼ŒJavaScriptæ˜¯ä¸€ç§åŸºäºåŸå‹çš„é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ã€‚å³ä¾¿JavaScriptç°åœ¨ä¹Ÿå¼•å…¥äº†ç±»çš„æ¦‚å¿µï¼Œä½†å®ƒä¹Ÿåªæ˜¯åŸºäºåŸå‹çš„è¯­æ³•ç³–è€Œå·²ã€‚ä¸è¿‡ï¼Œå¦‚æœä½ ç†Ÿæ‚‰çš„æ˜¯Javaã€C++ç­‰è¿™äº›ç¼–ç¨‹è¯­è¨€ï¼Œé‚£åœ¨å®é™…çš„å¼€å‘ä¸­ï¼Œå°±å¾ˆå°‘ç”¨åˆ°åŸå‹æ¨¡å¼äº†ã€‚</p><p>ä»Šå¤©çš„è®²è§£è·Ÿå…·ä½“æŸä¸€è¯­è¨€çš„è¯­æ³•æœºåˆ¶æ— å…³ï¼Œè€Œæ˜¯é€šè¿‡ä¸€ä¸ªcloneæ•£åˆ—è¡¨çš„ä¾‹å­å¸¦ä½ ææ¸…æ¥šï¼šåŸå‹æ¨¡å¼çš„åº”ç”¨åœºæ™¯ï¼Œä»¥åŠå®ƒçš„ä¸¤ç§å®ç°æ–¹å¼ï¼šæ·±æ‹·è´å’Œæµ…æ‹·è´ã€‚è™½ç„¶åŸå‹æ¨¡å¼çš„åŸç†å’Œä»£ç å®ç°éå¸¸ç®€å•ï¼Œä½†ä»Šå¤©ä¸¾çš„ä¾‹å­è¿˜æ˜¯ç¨å¾®æœ‰ç‚¹å¤æ‚çš„ï¼Œä½ è¦è·Ÿä¸Šæˆ‘çš„æ€è·¯ï¼Œå¤šåŠ¨è„‘æ€è€ƒä¸€ä¸‹ã€‚</p><p>è¯ä¸å¤šè¯´ï¼Œè®©æˆ‘ä»¬æ­£å¼å¼€å§‹ä»Šå¤©çš„å­¦ä¹ å§ï¼</p><h2>åŸå‹æ¨¡å¼çš„åŸç†ä¸åº”ç”¨</h2><p>å¦‚æœå¯¹è±¡çš„åˆ›å»ºæˆæœ¬æ¯”è¾ƒå¤§ï¼Œè€ŒåŒä¸€ä¸ªç±»çš„ä¸åŒå¯¹è±¡ä¹‹é—´å·®åˆ«ä¸å¤§ï¼ˆå¤§éƒ¨åˆ†å­—æ®µéƒ½ç›¸åŒï¼‰ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¯¹å·²æœ‰å¯¹è±¡ï¼ˆåŸå‹ï¼‰è¿›è¡Œå¤åˆ¶ï¼ˆæˆ–è€…å«æ‹·è´ï¼‰çš„æ–¹å¼æ¥åˆ›å»ºæ–°å¯¹è±¡ï¼Œä»¥è¾¾åˆ°èŠ‚çœåˆ›å»ºæ—¶é—´çš„ç›®çš„ã€‚è¿™ç§åŸºäºåŸå‹æ¥åˆ›å»ºå¯¹è±¡çš„æ–¹å¼å°±å«ä½œ<strong>åŸå‹è®¾è®¡æ¨¡å¼</strong>ï¼ˆPrototype Design Patternï¼‰ï¼Œç®€ç§°<strong>åŸå‹æ¨¡å¼</strong>ã€‚</p><!-- [[[read_end]]] --><p><strong>é‚£ä½•ä¸ºâ€œå¯¹è±¡çš„åˆ›å»ºæˆæœ¬æ¯”è¾ƒå¤§â€ï¼Ÿ</strong></p><p>å®é™…ä¸Šï¼Œåˆ›å»ºå¯¹è±¡åŒ…å«çš„ç”³è¯·å†…å­˜ã€ç»™æˆå‘˜å˜é‡èµ‹å€¼è¿™ä¸€è¿‡ç¨‹ï¼Œæœ¬èº«å¹¶ä¸ä¼šèŠ±è´¹å¤ªå¤šæ—¶é—´ï¼Œæˆ–è€…è¯´å¯¹äºå¤§éƒ¨åˆ†ä¸šåŠ¡ç³»ç»Ÿæ¥è¯´ï¼Œè¿™ç‚¹æ—¶é—´å®Œå…¨æ˜¯å¯ä»¥å¿½ç•¥çš„ã€‚åº”ç”¨ä¸€ä¸ªå¤æ‚çš„æ¨¡å¼ï¼Œåªå¾—åˆ°ä¸€ç‚¹ç‚¹çš„æ€§èƒ½æå‡ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„è¿‡åº¦è®¾è®¡ï¼Œå¾—ä¸å¿å¤±ã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚æœå¯¹è±¡ä¸­çš„æ•°æ®éœ€è¦ç»è¿‡å¤æ‚çš„è®¡ç®—æ‰èƒ½å¾—åˆ°ï¼ˆæ¯”å¦‚æ’åºã€è®¡ç®—å“ˆå¸Œå€¼ï¼‰ï¼Œæˆ–è€…éœ€è¦ä»RPCã€ç½‘ç»œã€æ•°æ®åº“ã€æ–‡ä»¶ç³»ç»Ÿç­‰éå¸¸æ…¢é€Ÿçš„IOä¸­è¯»å–ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨åŸå‹æ¨¡å¼ï¼Œä»å…¶ä»–å·²æœ‰å¯¹è±¡ä¸­ç›´æ¥æ‹·è´å¾—åˆ°ï¼Œè€Œä¸ç”¨æ¯æ¬¡åœ¨åˆ›å»ºæ–°å¯¹è±¡çš„æ—¶å€™ï¼Œéƒ½é‡å¤æ‰§è¡Œè¿™äº›è€—æ—¶çš„æ“ä½œã€‚</p><p><strong>è¿™ä¹ˆè¯´è¿˜æ˜¯æ¯”è¾ƒç†è®ºï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è§£é‡Šä¸€ä¸‹åˆšåˆšè¿™æ®µè¯ã€‚</strong></p><p>å‡è®¾æ•°æ®åº“ä¸­å­˜å‚¨äº†å¤§çº¦10ä¸‡æ¡â€œæœç´¢å…³é”®è¯â€ä¿¡æ¯ï¼Œæ¯æ¡ä¿¡æ¯åŒ…å«å…³é”®è¯ã€å…³é”®è¯è¢«æœç´¢çš„æ¬¡æ•°ã€ä¿¡æ¯æœ€è¿‘è¢«æ›´æ–°çš„æ—¶é—´ç­‰ã€‚ç³»ç»ŸAåœ¨å¯åŠ¨çš„æ—¶å€™ä¼šåŠ è½½è¿™ä»½æ•°æ®åˆ°å†…å­˜ä¸­ï¼Œç”¨äºå¤„ç†æŸäº›å…¶ä»–çš„ä¸šåŠ¡éœ€æ±‚ã€‚ä¸ºäº†æ–¹ä¾¿å¿«é€Ÿåœ°æŸ¥æ‰¾æŸä¸ªå…³é”®è¯å¯¹åº”çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬ç»™å…³é”®è¯å»ºç«‹ä¸€ä¸ªæ•£åˆ—è¡¨ç´¢å¼•ã€‚</p><p>å¦‚æœä½ ç†Ÿæ‚‰çš„æ˜¯Javaè¯­è¨€ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨è¯­è¨€ä¸­æä¾›çš„HashMapå®¹å™¨æ¥å®ç°ã€‚å…¶ä¸­ï¼ŒHashMapçš„keyä¸ºæœç´¢å…³é”®è¯ï¼Œvalueä¸ºå…³é”®è¯è¯¦ç»†ä¿¡æ¯ï¼ˆæ¯”å¦‚æœç´¢æ¬¡æ•°ï¼‰ã€‚æˆ‘ä»¬åªéœ€è¦å°†æ•°æ®ä»æ•°æ®åº“ä¸­è¯»å–å‡ºæ¥ï¼Œæ”¾å…¥HashMapå°±å¯ä»¥äº†ã€‚</p><p>ä¸è¿‡ï¼Œæˆ‘ä»¬è¿˜æœ‰å¦å¤–ä¸€ä¸ªç³»ç»ŸBï¼Œä¸“é—¨ç”¨æ¥åˆ†ææœç´¢æ—¥å¿—ï¼Œå®šæœŸï¼ˆæ¯”å¦‚é—´éš”10åˆ†é’Ÿï¼‰æ‰¹é‡åœ°æ›´æ–°æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œå¹¶ä¸”æ ‡è®°ä¸ºæ–°çš„æ•°æ®ç‰ˆæœ¬ã€‚æ¯”å¦‚ï¼Œåœ¨ä¸‹é¢çš„ç¤ºä¾‹å›¾ä¸­ï¼Œæˆ‘ä»¬å¯¹v2ç‰ˆæœ¬çš„æ•°æ®è¿›è¡Œæ›´æ–°ï¼Œå¾—åˆ°v3ç‰ˆæœ¬çš„æ•°æ®ã€‚è¿™é‡Œæˆ‘ä»¬å‡è®¾åªæœ‰æ›´æ–°å’Œæ–°æ·»å…³é”®è¯ï¼Œæ²¡æœ‰åˆ é™¤å…³é”®è¯çš„è¡Œä¸ºã€‚</p><p><img src="https://static001.geekbang.org/resource/image/05/0e/05233c28ddda51b81dfd946ffdef640e.jpg" alt=""></p><p>ä¸ºäº†ä¿è¯ç³»ç»ŸAä¸­æ•°æ®çš„å®æ—¶æ€§ï¼ˆä¸ä¸€å®šéå¸¸å®æ—¶ï¼Œä½†æ•°æ®ä¹Ÿä¸èƒ½å¤ªæ—§ï¼‰ï¼Œç³»ç»ŸAéœ€è¦å®šæœŸæ ¹æ®æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œæ›´æ–°å†…å­˜ä¸­çš„ç´¢å¼•å’Œæ•°æ®ã€‚</p><p>æˆ‘ä»¬è¯¥å¦‚ä½•å®ç°è¿™ä¸ªéœ€æ±‚å‘¢ï¼Ÿ</p><p>å®é™…ä¸Šï¼Œä¹Ÿä¸éš¾ã€‚æˆ‘ä»¬åªéœ€è¦åœ¨ç³»ç»ŸAä¸­ï¼Œè®°å½•å½“å‰æ•°æ®çš„ç‰ˆæœ¬Vaå¯¹åº”çš„æ›´æ–°æ—¶é—´Taï¼Œä»æ•°æ®åº“ä¸­æå‡ºæ›´æ–°æ—¶é—´å¤§äºTaçš„æ‰€æœ‰æœç´¢å…³é”®è¯ï¼Œä¹Ÿå°±æ˜¯æ‰¾å‡ºVaç‰ˆæœ¬ä¸æœ€æ–°ç‰ˆæœ¬æ•°æ®çš„â€œå·®é›†â€ï¼Œç„¶åé’ˆå¯¹å·®é›†ä¸­çš„æ¯ä¸ªå…³é”®è¯è¿›è¡Œå¤„ç†ã€‚å¦‚æœå®ƒå·²ç»åœ¨æ•£åˆ—è¡¨ä¸­å­˜åœ¨äº†ï¼Œæˆ‘ä»¬å°±æ›´æ–°ç›¸åº”çš„æœç´¢æ¬¡æ•°ã€æ›´æ–°æ—¶é—´ç­‰ä¿¡æ¯ï¼›å¦‚æœå®ƒåœ¨æ•£åˆ—è¡¨ä¸­ä¸å­˜åœ¨ï¼Œæˆ‘ä»¬å°±å°†å®ƒæ’å…¥åˆ°æ•£åˆ—è¡¨ä¸­ã€‚</p><p>æŒ‰ç…§è¿™ä¸ªè®¾è®¡æ€è·¯ï¼Œæˆ‘ç»™å‡ºçš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>public class Demo {
  private ConcurrentHashMap&lt;String, SearchWord&gt; currentKeywords = new ConcurrentHashMap&lt;&gt;();
  private long lastUpdateTime = -1;

  public void refresh() {
    // ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®ï¼Œæ”¾å…¥åˆ°currentKeywordsä¸­
    List&lt;SearchWord&gt; toBeUpdatedSearchWords = getSearchWords(lastUpdateTime);
    long maxNewUpdatedTime = lastUpdateTime;
    for (SearchWord searchWord : toBeUpdatedSearchWords) {
      if (searchWord.getLastUpdateTime() &gt; maxNewUpdatedTime) {
        maxNewUpdatedTime = searchWord.getLastUpdateTime();
      }
      if (currentKeywords.containsKey(searchWord.getKeyword())) {
        currentKeywords.replace(searchWord.getKeyword(), searchWord);
      } else {
        currentKeywords.put(searchWord.getKeyword(), searchWord);
      }
    }

    lastUpdateTime = maxNewUpdatedTime;
  }

  private List&lt;SearchWord&gt; getSearchWords(long lastUpdateTime) {
    // TODO: ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®
    return null;
  }
}
</code></pre><p>ä¸è¿‡ï¼Œç°åœ¨ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªç‰¹æ®Šçš„è¦æ±‚ï¼šä»»ä½•æ—¶åˆ»ï¼Œç³»ç»ŸAä¸­çš„æ‰€æœ‰æ•°æ®éƒ½å¿…é¡»æ˜¯åŒä¸€ä¸ªç‰ˆæœ¬çš„ï¼Œè¦ä¹ˆéƒ½æ˜¯ç‰ˆæœ¬aï¼Œè¦ä¹ˆéƒ½æ˜¯ç‰ˆæœ¬bï¼Œä¸èƒ½æœ‰çš„æ˜¯ç‰ˆæœ¬aï¼Œæœ‰çš„æ˜¯ç‰ˆæœ¬bã€‚é‚£åˆšåˆšçš„æ›´æ–°æ–¹å¼å°±ä¸èƒ½æ»¡è¶³è¿™ä¸ªè¦æ±‚äº†ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜è¦æ±‚ï¼šåœ¨æ›´æ–°å†…å­˜æ•°æ®çš„æ—¶å€™ï¼Œç³»ç»ŸAä¸èƒ½å¤„äºä¸å¯ç”¨çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½åœæœºæ›´æ–°æ•°æ®ã€‚</p><p>é‚£æˆ‘ä»¬è¯¥å¦‚ä½•å®ç°ç°åœ¨è¿™ä¸ªéœ€æ±‚å‘¢ï¼Ÿ</p><p>å®é™…ä¸Šï¼Œä¹Ÿä¸éš¾ã€‚æˆ‘ä»¬æŠŠæ­£åœ¨ä½¿ç”¨çš„æ•°æ®çš„ç‰ˆæœ¬å®šä¹‰ä¸ºâ€œæœåŠ¡ç‰ˆæœ¬â€ï¼Œå½“æˆ‘ä»¬è¦æ›´æ–°å†…å­˜ä¸­çš„æ•°æ®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¹¶ä¸æ˜¯ç›´æ¥åœ¨æœåŠ¡ç‰ˆæœ¬ï¼ˆå‡è®¾æ˜¯ç‰ˆæœ¬aæ•°æ®ï¼‰ä¸Šæ›´æ–°ï¼Œè€Œæ˜¯é‡æ–°åˆ›å»ºå¦ä¸€ä¸ªç‰ˆæœ¬æ•°æ®ï¼ˆå‡è®¾æ˜¯ç‰ˆæœ¬bæ•°æ®ï¼‰ï¼Œç­‰æ–°çš„ç‰ˆæœ¬æ•°æ®å»ºå¥½ä¹‹åï¼Œå†ä¸€æ¬¡æ€§åœ°å°†æœåŠ¡ç‰ˆæœ¬ä»ç‰ˆæœ¬aåˆ‡æ¢åˆ°ç‰ˆæœ¬bã€‚è¿™æ ·æ—¢ä¿è¯äº†æ•°æ®ä¸€ç›´å¯ç”¨ï¼Œåˆé¿å…äº†ä¸­é—´çŠ¶æ€çš„å­˜åœ¨ã€‚</p><p>æŒ‰ç…§è¿™ä¸ªè®¾è®¡æ€è·¯ï¼Œæˆ‘ç»™å‡ºçš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>public class Demo {
  private HashMap&lt;String, SearchWord&gt; currentKeywords=new HashMap&lt;&gt;();

  public void refresh() {
    HashMap&lt;String, SearchWord&gt; newKeywords = new LinkedHashMap&lt;&gt;();

    // ä»æ•°æ®åº“ä¸­å–å‡ºæ‰€æœ‰çš„æ•°æ®ï¼Œæ”¾å…¥åˆ°newKeywordsä¸­
    List&lt;SearchWord&gt; toBeUpdatedSearchWords = getSearchWords();
    for (SearchWord searchWord : toBeUpdatedSearchWords) {
      newKeywords.put(searchWord.getKeyword(), searchWord);
    }

    currentKeywords = newKeywords;
  }

  private List&lt;SearchWord&gt; getSearchWords() {
    // TODO: ä»æ•°æ®åº“ä¸­å–å‡ºæ‰€æœ‰çš„æ•°æ®
    return null;
  }
}
</code></pre><p>ä¸è¿‡ï¼Œåœ¨ä¸Šé¢çš„ä»£ç å®ç°ä¸­ï¼ŒnewKeywordsæ„å»ºçš„æˆæœ¬æ¯”è¾ƒé«˜ã€‚æˆ‘ä»¬éœ€è¦å°†è¿™10ä¸‡æ¡æ•°æ®ä»æ•°æ®åº“ä¸­è¯»å‡ºï¼Œç„¶åè®¡ç®—å“ˆå¸Œå€¼ï¼Œæ„å»ºnewKeywordsã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¾ç„¶æ˜¯æ¯”è¾ƒè€—æ—¶ã€‚ä¸ºäº†æé«˜æ•ˆç‡ï¼ŒåŸå‹æ¨¡å¼å°±æ´¾ä¸Šç”¨åœºäº†ã€‚</p><p>æˆ‘ä»¬æ‹·è´currentKeywordsæ•°æ®åˆ°newKeywordsä¸­ï¼Œç„¶åä»æ•°æ®åº“ä¸­åªæå‡ºæ–°å¢æˆ–è€…æœ‰æ›´æ–°çš„å…³é”®è¯ï¼Œæ›´æ–°åˆ°newKeywordsä¸­ã€‚è€Œç›¸å¯¹äº10ä¸‡æ¡æ•°æ®æ¥è¯´ï¼Œæ¯æ¬¡æ–°å¢æˆ–è€…æ›´æ–°çš„å…³é”®è¯ä¸ªæ•°æ˜¯æ¯”è¾ƒå°‘çš„ï¼Œæ‰€ä»¥ï¼Œè¿™ç§ç­–ç•¥å¤§å¤§æé«˜äº†æ•°æ®æ›´æ–°çš„æ•ˆç‡ã€‚</p><p>æŒ‰ç…§è¿™ä¸ªè®¾è®¡æ€è·¯ï¼Œæˆ‘ç»™å‡ºçš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>public class Demo {
  private HashMap&lt;String, SearchWord&gt; currentKeywords=new HashMap&lt;&gt;();
  private long lastUpdateTime = -1;

  public void refresh() {
    // åŸå‹æ¨¡å¼å°±è¿™ä¹ˆç®€å•ï¼Œæ‹·è´å·²æœ‰å¯¹è±¡çš„æ•°æ®ï¼Œæ›´æ–°å°‘é‡å·®å€¼
    HashMap&lt;String, SearchWord&gt; newKeywords = (HashMap&lt;String, SearchWord&gt;) currentKeywords.clone();

    // ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®ï¼Œæ”¾å…¥åˆ°newKeywordsä¸­
    List&lt;SearchWord&gt; toBeUpdatedSearchWords = getSearchWords(lastUpdateTime);
    long maxNewUpdatedTime = lastUpdateTime;
    for (SearchWord searchWord : toBeUpdatedSearchWords) {
      if (searchWord.getLastUpdateTime() &gt; maxNewUpdatedTime) {
        maxNewUpdatedTime = searchWord.getLastUpdateTime();
      }
      if (newKeywords.containsKey(searchWord.getKeyword())) {
        SearchWord oldSearchWord = newKeywords.get(searchWord.getKeyword());
        oldSearchWord.setCount(searchWord.getCount());
        oldSearchWord.setLastUpdateTime(searchWord.getLastUpdateTime());
      } else {
        newKeywords.put(searchWord.getKeyword(), searchWord);
      }
    }

    lastUpdateTime = maxNewUpdatedTime;
    currentKeywords = newKeywords;
  }

  private List&lt;SearchWord&gt; getSearchWords(long lastUpdateTime) {
    // TODO: ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®
    return null;
  }
}
</code></pre><p>è¿™é‡Œæˆ‘ä»¬åˆ©ç”¨äº†Javaä¸­çš„clone()è¯­æ³•æ¥å¤åˆ¶ä¸€ä¸ªå¯¹è±¡ã€‚å¦‚æœä½ ç†Ÿæ‚‰çš„è¯­è¨€æ²¡æœ‰è¿™ä¸ªè¯­æ³•ï¼Œé‚£æŠŠæ•°æ®ä»currentKeywordsä¸­ä¸€ä¸ªä¸ªå–å‡ºæ¥ï¼Œç„¶åå†é‡æ–°è®¡ç®—å“ˆå¸Œå€¼ï¼Œæ”¾å…¥åˆ°newKeywordsä¸­ä¹Ÿæ˜¯å¯ä»¥æ¥å—çš„ã€‚æ¯•ç«Ÿï¼Œæœ€è€—æ—¶çš„è¿˜æ˜¯ä»æ•°æ®åº“ä¸­å–æ•°æ®çš„æ“ä½œã€‚ç›¸å¯¹äºæ•°æ®åº“çš„IOæ“ä½œæ¥è¯´ï¼Œå†…å­˜æ“ä½œå’ŒCPUè®¡ç®—çš„è€—æ—¶éƒ½æ˜¯å¯ä»¥å¿½ç•¥çš„ã€‚</p><p>ä¸è¿‡ï¼Œä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰å‘ç°ï¼Œå®é™…ä¸Šï¼Œåˆšåˆšçš„ä»£ç å®ç°æ˜¯æœ‰é—®é¢˜çš„ã€‚è¦å¼„æ˜ç™½åˆ°åº•æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£å¦å¤–ä¸¤ä¸ªæ¦‚å¿µï¼šæ·±æ‹·è´ï¼ˆDeep Copyï¼‰å’Œæµ…æ‹·è´ï¼ˆShallow Copyï¼‰ã€‚</p><h2>åŸå‹æ¨¡å¼çš„å®ç°æ–¹å¼ï¼šæ·±æ‹·è´å’Œæµ…æ‹·è´</h2><p>æˆ‘ä»¬æ¥çœ‹ï¼Œåœ¨å†…å­˜ä¸­ï¼Œç”¨æ•£åˆ—è¡¨ç»„ç»‡çš„æœç´¢å…³é”®è¯ä¿¡æ¯æ˜¯å¦‚ä½•å­˜å‚¨çš„ã€‚æˆ‘ç”»äº†ä¸€å¼ ç¤ºæ„å›¾ï¼Œå¤§è‡´ç»“æ„å¦‚ä¸‹æ‰€ç¤ºã€‚ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæ•£åˆ—è¡¨ç´¢å¼•ä¸­ï¼Œæ¯ä¸ªç»“ç‚¹å­˜å‚¨çš„keyæ˜¯æœç´¢å…³é”®è¯ï¼Œvalueæ˜¯SearchWordå¯¹è±¡çš„å†…å­˜åœ°å€ã€‚SearchWordå¯¹è±¡æœ¬èº«å­˜å‚¨åœ¨æ•£åˆ—è¡¨ä¹‹å¤–çš„å†…å­˜ç©ºé—´ä¸­ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/f5/d2/f5ba85952b27a569687e2d44352216d2.jpg" alt=""></p><p>æµ…æ‹·è´å’Œæ·±æ‹·è´çš„åŒºåˆ«åœ¨äºï¼Œæµ…æ‹·è´åªä¼šå¤åˆ¶å›¾ä¸­çš„ç´¢å¼•ï¼ˆæ•£åˆ—è¡¨ï¼‰ï¼Œä¸ä¼šå¤åˆ¶æ•°æ®ï¼ˆSearchWordå¯¹è±¡ï¼‰æœ¬èº«ã€‚ç›¸åï¼Œæ·±æ‹·è´ä¸ä»…ä»…ä¼šå¤åˆ¶ç´¢å¼•ï¼Œè¿˜ä¼šå¤åˆ¶æ•°æ®æœ¬èº«ã€‚æµ…æ‹·è´å¾—åˆ°çš„å¯¹è±¡ï¼ˆnewKeywordsï¼‰è·ŸåŸå§‹å¯¹è±¡ï¼ˆcurrentKeywordsï¼‰å…±äº«æ•°æ®ï¼ˆSearchWordå¯¹è±¡ï¼‰ï¼Œè€Œæ·±æ‹·è´å¾—åˆ°çš„æ˜¯ä¸€ä»½å®Œå®Œå…¨å…¨ç‹¬ç«‹çš„å¯¹è±¡ã€‚å…·ä½“çš„å¯¹æ¯”å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://static001.geekbang.org/resource/image/74/82/74bceb7a0736957daaa4abeba6826182.jpg" alt=""></p><p><img src="https://static001.geekbang.org/resource/image/b9/1b/b978d054ab3183b9e0ae461e6abac81b.jpg" alt=""></p><p>åœ¨Javaè¯­è¨€ä¸­ï¼ŒObjectç±»çš„clone()æ–¹æ³•æ‰§è¡Œçš„å°±æ˜¯æˆ‘ä»¬åˆšåˆšè¯´çš„æµ…æ‹·è´ã€‚å®ƒåªä¼šæ‹·è´å¯¹è±¡ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹çš„æ•°æ®ï¼ˆæ¯”å¦‚ï¼Œintã€longï¼‰ï¼Œä»¥åŠå¼•ç”¨å¯¹è±¡ï¼ˆSearchWordï¼‰çš„å†…å­˜åœ°å€ï¼Œä¸ä¼šé€’å½’åœ°æ‹·è´å¼•ç”¨å¯¹è±¡æœ¬èº«ã€‚</p><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨HashMapä¸Šçš„clone()æµ…æ‹·è´æ–¹æ³•æ¥å®ç°åŸå‹æ¨¡å¼ã€‚å½“æˆ‘ä»¬é€šè¿‡newKeywordsæ›´æ–°SearchWordå¯¹è±¡çš„æ—¶å€™ï¼ˆæ¯”å¦‚ï¼Œæ›´æ–°â€œè®¾è®¡æ¨¡å¼â€è¿™ä¸ªæœç´¢å…³é”®è¯çš„è®¿é—®æ¬¡æ•°ï¼‰ï¼ŒnewKeywordså’ŒcurrentKeywordså› ä¸ºæŒ‡å‘ç›¸åŒçš„ä¸€ç»„SearchWordå¯¹è±¡ï¼Œå°±ä¼šå¯¼è‡´currentKeywordsä¸­æŒ‡å‘çš„SearchWordï¼Œæœ‰çš„æ˜¯è€ç‰ˆæœ¬çš„ï¼Œæœ‰çš„æ˜¯æ–°ç‰ˆæœ¬çš„ï¼Œå°±æ²¡æ³•æ»¡è¶³æˆ‘ä»¬ä¹‹å‰çš„éœ€æ±‚ï¼šcurrentKeywordsä¸­çš„æ•°æ®åœ¨ä»»ä½•æ—¶åˆ»éƒ½æ˜¯åŒä¸€ä¸ªç‰ˆæœ¬çš„ï¼Œä¸å­˜åœ¨ä»‹äºè€ç‰ˆæœ¬ä¸æ–°ç‰ˆæœ¬ä¹‹é—´çš„ä¸­é—´çŠ¶æ€ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬åˆè¯¥å¦‚ä½•æ¥è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å¯ä»¥å°†æµ…æ‹·è´æ›¿æ¢ä¸ºæ·±æ‹·è´ã€‚newKeywordsä¸ä»…ä»…å¤åˆ¶currentKeywordsçš„ç´¢å¼•ï¼Œè¿˜æŠŠSearchWordå¯¹è±¡ä¹Ÿå¤åˆ¶ä¸€ä»½å‡ºæ¥ï¼Œè¿™æ ·newKeywordså’ŒcurrentKeywordså°±æŒ‡å‘ä¸åŒçš„SearchWordå¯¹è±¡ï¼Œä¹Ÿå°±ä¸å­˜åœ¨æ›´æ–°newKeywordsçš„æ•°æ®ä¼šå¯¼è‡´currentKeywordsçš„æ•°æ®ä¹Ÿè¢«æ›´æ–°çš„é—®é¢˜äº†ã€‚</p><p>é‚£å¦‚ä½•å®ç°æ·±æ‹·è´å‘¢ï¼Ÿæ€»ç»“ä¸€ä¸‹çš„è¯ï¼Œæœ‰ä¸‹é¢ä¸¤ç§æ–¹æ³•ã€‚</p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šé€’å½’æ‹·è´å¯¹è±¡ã€å¯¹è±¡çš„å¼•ç”¨å¯¹è±¡ä»¥åŠå¼•ç”¨å¯¹è±¡çš„å¼•ç”¨å¯¹è±¡â€¦â€¦ç›´åˆ°è¦æ‹·è´çš„å¯¹è±¡åªåŒ…å«åŸºæœ¬æ•°æ®ç±»å‹æ•°æ®ï¼Œæ²¡æœ‰å¼•ç”¨å¯¹è±¡ä¸ºæ­¢ã€‚æ ¹æ®è¿™ä¸ªæ€è·¯å¯¹ä¹‹å‰çš„ä»£ç è¿›è¡Œé‡æ„ã€‚é‡æ„ä¹‹åçš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>public class Demo {
  private HashMap&lt;String, SearchWord&gt; currentKeywords=new HashMap&lt;&gt;();
  private long lastUpdateTime = -1;

  public void refresh() {
    // Deep copy
    HashMap&lt;String, SearchWord&gt; newKeywords = new HashMap&lt;&gt;();
    for (HashMap.Entry&lt;String, SearchWord&gt; e : currentKeywords.entrySet()) {
      SearchWord searchWord = e.getValue();
      SearchWord newSearchWord = new SearchWord(
              searchWord.getKeyword(), searchWord.getCount(), searchWord.getLastUpdateTime());
      newKeywords.put(e.getKey(), newSearchWord);
    }

    // ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®ï¼Œæ”¾å…¥åˆ°newKeywordsä¸­
    List&lt;SearchWord&gt; toBeUpdatedSearchWords = getSearchWords(lastUpdateTime);
    long maxNewUpdatedTime = lastUpdateTime;
    for (SearchWord searchWord : toBeUpdatedSearchWords) {
      if (searchWord.getLastUpdateTime() &gt; maxNewUpdatedTime) {
        maxNewUpdatedTime = searchWord.getLastUpdateTime();
      }
      if (newKeywords.containsKey(searchWord.getKeyword())) {
        SearchWord oldSearchWord = newKeywords.get(searchWord.getKeyword());
        oldSearchWord.setCount(searchWord.getCount());
        oldSearchWord.setLastUpdateTime(searchWord.getLastUpdateTime());
      } else {
        newKeywords.put(searchWord.getKeyword(), searchWord);
      }
    }

    lastUpdateTime = maxNewUpdatedTime;
    currentKeywords = newKeywords;
  }

  private List&lt;SearchWord&gt; getSearchWords(long lastUpdateTime) {
    // TODO: ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®
    return null;
  }

}
</code></pre><p>ç¬¬äºŒç§æ–¹æ³•ï¼šå…ˆå°†å¯¹è±¡åºåˆ—åŒ–ï¼Œç„¶åå†ååºåˆ—åŒ–æˆæ–°çš„å¯¹è±¡ã€‚å…·ä½“çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>public Object deepCopy(Object object) {
  ByteArrayOutputStream bo = new ByteArrayOutputStream();
  ObjectOutputStream oo = new ObjectOutputStream(bo);
  oo.writeObject(object);
  
  ByteArrayInputStream bi = new ByteArrayInputStream(bo.toByteArray());
  ObjectInputStream oi = new ObjectInputStream(bi);
  
  return oi.readObject();
}
</code></pre><p>åˆšåˆšçš„ä¸¤ç§å®ç°æ–¹æ³•ï¼Œä¸ç®¡é‡‡ç”¨å“ªç§ï¼Œæ·±æ‹·è´éƒ½è¦æ¯”æµ…æ‹·è´è€—æ—¶ã€è€—å†…å­˜ç©ºé—´ã€‚é’ˆå¯¹æˆ‘ä»¬è¿™ä¸ªåº”ç”¨åœºæ™¯ï¼Œæœ‰æ²¡æœ‰æ›´å¿«ã€æ›´çœå†…å­˜çš„å®ç°æ–¹å¼å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å¯ä»¥å…ˆé‡‡ç”¨æµ…æ‹·è´çš„æ–¹å¼åˆ›å»ºnewKeywordsã€‚å¯¹äºéœ€è¦æ›´æ–°çš„SearchWordå¯¹è±¡ï¼Œæˆ‘ä»¬å†ä½¿ç”¨æ·±åº¦æ‹·è´çš„æ–¹å¼åˆ›å»ºä¸€ä»½æ–°çš„å¯¹è±¡ï¼Œæ›¿æ¢newKeywordsä¸­çš„è€å¯¹è±¡ã€‚æ¯•ç«Ÿéœ€è¦æ›´æ–°çš„æ•°æ®æ˜¯å¾ˆå°‘çš„ã€‚è¿™ç§æ–¹å¼å³åˆ©ç”¨äº†æµ…æ‹·è´èŠ‚çœæ—¶é—´ã€ç©ºé—´çš„ä¼˜ç‚¹ï¼Œåˆèƒ½ä¿è¯currentKeywordsä¸­çš„ä¸­æ•°æ®éƒ½æ˜¯è€ç‰ˆæœ¬çš„æ•°æ®ã€‚å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºã€‚è¿™ä¹Ÿæ˜¯æ ‡é¢˜ä¸­è®²åˆ°çš„ï¼Œåœ¨æˆ‘ä»¬è¿™ä¸ªåº”ç”¨åœºæ™¯ä¸‹ï¼Œæœ€å¿«é€Ÿcloneæ•£åˆ—è¡¨çš„æ–¹å¼ã€‚</p><pre><code>public class Demo {
  private HashMap&lt;String, SearchWord&gt; currentKeywords=new HashMap&lt;&gt;();
  private long lastUpdateTime = -1;

  public void refresh() {
    // Shallow copy
    HashMap&lt;String, SearchWord&gt; newKeywords = (HashMap&lt;String, SearchWord&gt;) currentKeywords.clone();

    // ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®ï¼Œæ”¾å…¥åˆ°newKeywordsä¸­
    List&lt;SearchWord&gt; toBeUpdatedSearchWords = getSearchWords(lastUpdateTime);
    long maxNewUpdatedTime = lastUpdateTime;
    for (SearchWord searchWord : toBeUpdatedSearchWords) {
      if (searchWord.getLastUpdateTime() &gt; maxNewUpdatedTime) {
        maxNewUpdatedTime = searchWord.getLastUpdateTime();
      }
      if (newKeywords.containsKey(searchWord.getKeyword())) {
        newKeywords.remove(searchWord.getKeyword());
      }
      newKeywords.put(searchWord.getKeyword(), searchWord);
    }

    lastUpdateTime = maxNewUpdatedTime;
    currentKeywords = newKeywords;
  }

  private List&lt;SearchWord&gt; getSearchWords(long lastUpdateTime) {
    // TODO: ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®
    return null;
  }
}
</code></pre><h2>é‡ç‚¹å›é¡¾</h2><p>å¥½äº†ï¼Œä»Šå¤©çš„å†…å®¹åˆ°æ­¤å°±è®²å®Œäº†ã€‚æˆ‘ä»¬ä¸€å—æ¥æ€»ç»“å›é¡¾ä¸€ä¸‹ï¼Œä½ éœ€è¦é‡ç‚¹æŒæ¡çš„å†…å®¹ã€‚</p><p><strong>1.ä»€ä¹ˆæ˜¯åŸå‹æ¨¡å¼ï¼Ÿ</strong></p><p>å¦‚æœå¯¹è±¡çš„åˆ›å»ºæˆæœ¬æ¯”è¾ƒå¤§ï¼Œè€ŒåŒä¸€ä¸ªç±»çš„ä¸åŒå¯¹è±¡ä¹‹é—´å·®åˆ«ä¸å¤§ï¼ˆå¤§éƒ¨åˆ†å­—æ®µéƒ½ç›¸åŒï¼‰ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¯¹å·²æœ‰å¯¹è±¡ï¼ˆåŸå‹ï¼‰è¿›è¡Œå¤åˆ¶ï¼ˆæˆ–è€…å«æ‹·è´ï¼‰çš„æ–¹å¼ï¼Œæ¥åˆ›å»ºæ–°å¯¹è±¡ï¼Œä»¥è¾¾åˆ°èŠ‚çœåˆ›å»ºæ—¶é—´çš„ç›®çš„ã€‚è¿™ç§åŸºäºåŸå‹æ¥åˆ›å»ºå¯¹è±¡çš„æ–¹å¼å°±å«ä½œåŸå‹è®¾è®¡æ¨¡å¼ï¼Œç®€ç§°åŸå‹æ¨¡å¼ã€‚</p><p><strong>2.åŸå‹æ¨¡å¼çš„ä¸¤ç§å®ç°æ–¹æ³•</strong></p><p>åŸå‹æ¨¡å¼æœ‰ä¸¤ç§å®ç°æ–¹æ³•ï¼Œæ·±æ‹·è´å’Œæµ…æ‹·è´ã€‚æµ…æ‹·è´åªä¼šå¤åˆ¶å¯¹è±¡ä¸­åŸºæœ¬æ•°æ®ç±»å‹æ•°æ®å’Œå¼•ç”¨å¯¹è±¡çš„å†…å­˜åœ°å€ï¼Œä¸ä¼šé€’å½’åœ°å¤åˆ¶å¼•ç”¨å¯¹è±¡ï¼Œä»¥åŠå¼•ç”¨å¯¹è±¡çš„å¼•ç”¨å¯¹è±¡â€¦â€¦è€Œæ·±æ‹·è´å¾—åˆ°çš„æ˜¯ä¸€ä»½å®Œå®Œå…¨å…¨ç‹¬ç«‹çš„å¯¹è±¡ã€‚æ‰€ä»¥ï¼Œæ·±æ‹·è´æ¯”èµ·æµ…æ‹·è´æ¥è¯´ï¼Œæ›´åŠ è€—æ—¶ï¼Œæ›´åŠ è€—å†…å­˜ç©ºé—´ã€‚</p><p>å¦‚æœè¦æ‹·è´çš„å¯¹è±¡æ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œæµ…æ‹·è´å…±äº«ä¸å¯å˜å¯¹è±¡æ˜¯æ²¡é—®é¢˜çš„ï¼Œä½†å¯¹äºå¯å˜å¯¹è±¡æ¥è¯´ï¼Œæµ…æ‹·è´å¾—åˆ°çš„å¯¹è±¡å’ŒåŸå§‹å¯¹è±¡ä¼šå…±äº«éƒ¨åˆ†æ•°æ®ï¼Œå°±æœ‰å¯èƒ½å‡ºç°æ•°æ®è¢«ä¿®æ”¹çš„é£é™©ï¼Œä¹Ÿå°±å˜å¾—å¤æ‚å¤šäº†ã€‚é™¤éåƒæˆ‘ä»¬ä»Šå¤©å®æˆ˜ä¸­ä¸¾çš„é‚£ä¸ªä¾‹å­ï¼Œéœ€è¦ä»æ•°æ®åº“ä¸­åŠ è½½10ä¸‡æ¡æ•°æ®å¹¶æ„å»ºæ•£åˆ—è¡¨ç´¢å¼•ï¼Œæ“ä½œéå¸¸è€—æ—¶ï¼Œæ¯”è¾ƒæ¨èä½¿ç”¨æµ…æ‹·è´ï¼Œå¦åˆ™ï¼Œæ²¡æœ‰å……åˆ†çš„ç†ç”±ï¼Œä¸è¦ä¸ºäº†ä¸€ç‚¹ç‚¹çš„æ€§èƒ½æå‡è€Œä½¿ç”¨æµ…æ‹·è´ã€‚</p><h2>è¯¾å ‚è®¨è®º</h2><ol>
<li>åœ¨ä»Šå¤©çš„åº”ç”¨åœºæ™¯ä¸­ï¼Œå¦‚æœä¸ä»…å¾€æ•°æ®åº“ä¸­æ·»åŠ å’Œæ›´æ–°å…³é”®è¯ï¼Œè¿˜åˆ é™¤å…³é”®è¯ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œåˆè¯¥å¦‚ä½•å®ç°å‘¢ï¼Ÿ</li>
<li>åœ¨<a href="https://time.geekbang.org/column/article/164907">ç¬¬7è®²</a>ä¸­ï¼Œä¸ºäº†è®©ShoppingCartçš„getItems()æ–¹æ³•è¿”å›ä¸å¯å˜å¯¹è±¡ï¼Œæˆ‘ä»¬å¦‚ä¸‹æ¥å®ç°ä»£ç ã€‚å½“æ—¶ï¼Œæˆ‘ä»¬æŒ‡å‡ºè¿™æ ·çš„å®ç°æ€è·¯è¿˜æ˜¯æœ‰ç‚¹é—®é¢˜ã€‚å› ä¸ºå½“è°ƒç”¨è€…é€šè¿‡ShoppingCartçš„getItems()è·å–åˆ°itemsä¹‹åï¼Œæˆ‘ä»¬è¿˜æ˜¯å¯ä»¥ä¿®æ”¹å®¹å™¨ä¸­æ¯ä¸ªå¯¹è±¡ï¼ˆShoppingCartItemï¼‰çš„æ•°æ®ã€‚å­¦å®Œæœ¬èŠ‚è¯¾ä¹‹åï¼Œç°åœ¨ä½ æœ‰æ²¡æœ‰è§£å†³æ–¹æ³•äº†å‘¢ï¼Ÿ</li>
</ol><pre><code>public class ShoppingCart {
  // ...çœç•¥å…¶ä»–ä»£ç ...
  public List&lt;ShoppingCartItem&gt; getItems() {
    return Collections.unmodifiableList(this.items);
  }
}

// Testing Code in main method:
ShoppingCart cart = new ShoppingCart();
List&lt;ShoppingCartItem&gt; items = cart.getItems();
items.clear();//try to modify the list
// Exception in thread &quot;main&quot; java.lang.UnsupportedOperationExceptio 

ShoppingCart cart = new ShoppingCart();
cart.add(new ShoppingCartItem(...));
List&lt;ShoppingCartItem&gt; items = cart.getItems();
ShoppingCartItem item = items.get(0);
item.setPrice(19.0); // è¿™é‡Œä¿®æ”¹äº†itemçš„ä»·æ ¼å±æ€§
</code></pre><p>æ¬¢è¿ç•™è¨€å’Œæˆ‘åˆ†äº«ä½ çš„ç–‘æƒ‘å’Œè§è§£ï¼Œå¦‚æœæœ‰æ”¶è·ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚</p><h2>ç²¾é€‰ç•™è¨€ï¼š</h2>
        <ul>
        
<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            å¹³é£é€ é›¨  2020-02-19 23:36:14
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            1. ä¸¤ä¸ªMapæ¯”è¾ƒä¸‹keyæ‰¾åˆ°å·®é›†<br>2. å¯ä»¥è¿”å›æ·±å¤åˆ¶çš„è´­ç‰©è½¦ç»“æ„ï¼Œæˆ–è€…å¹²è„†åˆ†æˆä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªè¿”å›æ·±å¤åˆ¶çš„ç»“æ„ï¼Œä¸€ä¸ªè¿”å›å½“å‰ç»“æ„ï¼ŒåŒºåˆ†ä½¿ç”¨åœºæ™¯ã€‚ [1èµ]
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            è¾£ä¹ˆå¤§  2020-02-19 20:58:03
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            é—®é¢˜1:<br>æ–¹æ³•ä¸€ï¼šæ–°æ—§çš„æ•°æ®å–äº¤é›†ï¼Œå¯ä»¥åˆ é™¤æ—§mapä¸­çš„åˆ é™¤å…³é”®å­—ï¼Œä¹‹åçš„é€»è¾‘å°±å’Œæ–‡ç« ä¸­ä¸€æ ·äº†ã€‚<br>æ–¹æ³•äºŒï¼šé€»è¾‘åˆ é™¤ï¼Œå½“mapçš„sizeä¸­å·²åˆ é™¤å æ¯”è¿‡é«˜æ—¶ï¼Œresize mapã€‚<br><br>äº‰å“¥è¯´ï¼šè¿™é‡Œæˆ‘ä»¬åˆ©ç”¨äº† Java ä¸­çš„ clone() è¯­æ³•æ¥å¤åˆ¶ä¸€ä¸ªå¯¹è±¡ã€‚å¦‚æœä½ ç†Ÿæ‚‰çš„è¯­è¨€æ²¡æœ‰è¿™ä¸ªè¯­æ³•ï¼Œé‚£æŠŠæ•°æ®ä» currentKeywords ä¸­ä¸€ä¸ªä¸ªå–å‡ºæ¥ï¼Œç„¶åå†é‡æ–°è®¡ç®—å“ˆå¸Œå€¼ï¼Œæ”¾å…¥åˆ° newKeywords ä¸­ä¹Ÿæ˜¯å¯ä»¥æ¥å—çš„ã€‚<br><br>Java HashMapçš„cloneæ–¹æ³•å°±æŠŠæ•°æ®å–å‡ºæ¥ï¼Œè®¡ç®—hashå€¼ï¼Œåœ¨æ”¾å›å»çš„ã€‚cloneæ–¹æ³•ä¸­ï¼Œè°ƒç”¨äº†putMapEntriesæ–¹æ³•ï¼Œå…¶ä¸­æœ‰ä¸€å…³é”®çš„ä¸€è¡Œï¼Œå…‹éš†é‡æ–°è®¡ç®—äº†hashå€¼ï¼š<br>putVal(hash(key), key, value, false, evict); <br><br>æ–‡ç« ä¸­çš„æ·±å¤åˆ¶ï¼šä¸ºä»€ä¹ˆSearchWordä¸é‡å†™cloneæ–¹æ³•å‘¢ï¼Ÿ<br>@Override<br>protected Object clone() throws CloneNotSupportedException {<br>  SearchWord newWord = new SearchWord(this.keyWord, this.times, this.tmstamp);<br>  return newWord;<br>}<br> [1èµ]
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            Frank  2020-02-19 22:40:04
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            åŸå‹æ¨¡å¼æ˜¯ä¸€ç§ä»â€œæ‹·è´â€çš„è§’åº¦æ¥åˆ›å»ºå¯¹è±¡çš„æ–¹å¼ï¼Œä»¥å®ç°èŠ‚çœæ—¶é—´çš„ç›®çš„ã€‚åŸå‹æ¨¡å¼æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼šæµ…æ‹·è´ä¸æ·±æ‹·è´ã€‚ç†è§£å…¶åº”ç”¨åœºæ™¯ï¼šå¯¹è±¡åˆ›å»ºæˆæœ¬å¤§ï¼ŒåŒä¸€ä¸ªç±»ä¸åŒå¯¹è±¡ä¹‹é—´å·®åˆ«ä¸å¤§ã€‚ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            æˆ‘æ¥ä¹Ÿ  2020-02-19 22:37:14
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            æ€è€ƒé¢˜2:<br>å³ä½¿æ˜¯æ·±æ‹·è´ï¼Œä¹Ÿæ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼Œåªæ˜¯ä¿®æ”¹çš„ä¸æ˜¯åŸæ•°æ®è€Œå·²ã€‚<br><br>æˆ‘å¯¹javaè¯­æ³•ä¸ç†Ÿï¼Œä¸çŸ¥é“å¯å¦é€’å½’çš„ä½¿ç”¨  Collections.unmodifiableList ç±»ä¼¼çš„æ–¹å¼ï¼Œæ„å»ºä¸€ä¸ªæ–°çš„æ·±æ‹·è´å¯¹è±¡ã€‚ç„¶åå†è¿”å›è¿™ä¸ªå¯¹è±¡çš„ä¸å¯ä¿®æ”¹å‰¯æœ¬ã€‚<br><br>è¿™æ ·è¿™ä¸ªå¯¹è±¡ä»é‡Œåˆ°å¤–éƒ½æ˜¯ä¸å¯ä¿®æ”¹çš„å±æ€§äº†ã€‚ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            å¿†æ°´å¯’  2020-02-19 21:28:40
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            è®©æˆ‘æƒ³åˆ°äº†linuxä¸‹é¢forkï¼Œå…¶å®å†…æ ¸ä¹Ÿæ˜¯æ‹·è´äº†ä¸€ä»½æ•°æ®ã€‚Javaé‡Œé¢çš„copyonwriteæ˜¯ä¸æ˜¯ä¹Ÿæ˜¯è¿™ç§æ·±æ‹·è´åŸç†å‘¢ï¼Ÿ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            LğŸš²ğŸ±  2020-02-19 15:51:17
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            é—®é¢˜ 1: é€»è¾‘åˆ é™¤å³å¯<br>é—®é¢˜ 2:  è¿”å›æ·±æ‹·è´å¯¹è±¡ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            aoe  2020-02-19 15:04:43
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            åŸæ¥æ‹·è´å¯ä»¥è¿™æ ·æ“ä½œï¼ä½©æœå°äº‰å“¥ç®—æ³•ä¸æ•°æ®ç»“æ„ç”¨çš„6ï¼ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            ï¼Œ  2020-02-19 13:28:56
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            é—®é¢˜1:<br>1.è®¾ç½®æ ‡è®°ä½,&quot;ä½¿ç”¨ä¸­&quot;,&quot;å¼ƒç”¨&quot;,&quot;å·²åˆ é™¤&quot;ç­‰,æ£€æŸ¥åˆ°æ ‡è®°ä¸º&quot;å¼ƒç”¨&quot;çš„æ•°æ®æ—¶,åˆ é™¤mapé‡Œçš„æ•°æ®åŒæ—¶ä¿®æ”¹æ ‡è®°ä½ä¸º&quot;å·²åˆ é™¤&quot;,æ‰«ææ•°æ®åº“é‡Œæ›´æ–°çš„æ•°æ®æ—¶å¢åŠ æ£€ç´¢æ¡ä»¶&quot;ä½¿ç”¨ä¸­&quot;<br>2.æ¯æ¬¡æ•°æ®åº“éƒ½å…¨é‡æ‰«æ,æ‹¿åˆ°æ ‡è®°ä½ä¸º&quot;ä½¿ç”¨ä¸­&quot;çš„æ•°æ®,ç›´æ¥æ›¿æ¢map<br>3.åˆ é™¤æ•°æ®æ—¶åŒæ—¶åˆ é™¤æ•°æ®åº“å’Œmapé‡Œçš„æ•°æ®<br>  ä¸ªäººè®¤ä¸ºæ–¹æ³•1å’Œæ–¹æ³•3éƒ½å¾ˆåˆé€‚,æ–¹æ³•äºŒå¯¹æ•°æ®åº“IOæ“ä½œé‡æ¯”è¾ƒå¤§,ä¸å¤ªé€‚åˆ<br>é—®é¢˜2:<br>è¿”å›æ·±å…‹éš†å¯¹è±¡å³å¯ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            Jxin  2020-02-19 13:06:53
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            1.é€»è¾‘åˆ é™¤çš„è¯ï¼Œä»£ç éƒ½ä¸ç”¨æ”¹ã€‚ç‰©ç†åˆ é™¤çš„è¯ï¼Œæˆ‘è§‰å¾—åœ¨åˆ é™¤æ—¶è”åŠ¨æ¸…é™¤mapçš„ç¼“å­˜å¯è¡Œï¼ˆå•è¿›ç¨‹ï¼Œåˆ†å¸ƒå¼å°±å¾—å¼•å…¥ä¸€ä¸ªå¤–éƒ¨å­˜å‚¨ï¼Œå‘ŠçŸ¥æ‰€æœ‰èŠ‚ç‚¹åˆ é™¤æŸä¸ªç¼“å­˜ï¼‰ã€‚<br><br><br>2.æ ¹æ®ä¸šåŠ¡åœºæ™¯ï¼Œé‡‡ç”¨cowå†™æ—¶å¤åˆ¶ã€‚æä¾›åªè¯»çš„åˆ—è¡¨è¿”å›å’Œå†™æ—¶çš„å¤åˆ¶åˆ—è¡¨çš„è¿”å›ä¸¤ä¸ªæ–¹æ³•ã€‚ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            webmin  2020-02-19 11:37:55
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            é—®é¢˜ä¸€ï¼š<br>       for (SearchWord searchWord : toBeUpdatedSearchWords) {<br>        ...<br>        }<br>        Set&lt;String&gt; toBeUpdatedKeys = new HashSet&lt;&gt;();<br>        toBeUpdatedSearchWords.forEach((k) -&gt; toBeUpdatedKeys.add(k.getKeyword()));<br>        List&lt;String&gt; removeList = newKeywords.keySet().stream().filter((key) -&gt; !toBeUpdatedKeys.contains(key)).collect(Collectors.toList());<br>        removeList.forEach(newKeywords::remove);<br>é—®é¢˜äºŒï¼š<br>è¿”å›ä¸å¯å˜å¯¹è±¡ï¼Œæ–¹æ³•æœ‰ä¸¤ä¸ª<br>æ–¹æ³•1ï¼šè¯­è¨€è‡ªå¸¦æˆ–ç¬¬ä¸‰æ–¹åº“çš„ä¸å¯å˜å¯¹è±¡æœºåˆ¶ï¼Œå¦‚ï¼šJavaå¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“Guavaçš„ä¸å¯å˜é›†åˆï¼›<br>æ–¹æ³•2ï¼šè¿”å›ä¸€ä¸ªæ·±æ‹·è´å¯¹è±¡ï¼› 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            å°æ™å­  2020-02-19 10:59:54
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            1. è€ƒè™‘åˆ°åˆ é™¤å…³é”®è¯ï¼Œé‚£ä¹ˆæœ€å¥½æ•°æ®åº“ä½¿ç”¨è½¯åˆ é™¤ï¼Œè¿™æ ·å¯ä»¥çŸ¥é“å“ªäº›å…³é”®è¯æ˜¯è¢«åˆ é™¤çš„ï¼Œé‚£ä¹ˆæ‹¿åˆ°è¿™äº›è¢«åˆ é™¤çš„å…³é”®è¯å°±å¯ä»¥åœ¨cloneå‡ºæ¥çš„newKeywordsåŸºç¡€ä¸Šï¼Œç›´æ¥removeæ‰å·²ç»åˆ é™¤çš„å“ªäº›å…³é”®è¯å°±å¯ä»¥äº†ã€‚åä¹‹å¦‚æœä¸æ˜¯ä½¿ç”¨çš„è½¯åˆ é™¤ï¼Œé‚£ä¹ˆå°±ä¸å¥½ä½¿ç”¨åŸå‹æ¨¡å¼ï¼Œéœ€è¦è·å–æ–°ç‰ˆæœ¬å…¨é‡æ•°æ®ï¼Œç„¶åå’Œæ—§ç‰ˆæœ¬æ•°æ®ä¸€ä¸€æ¯”å¯¹ï¼Œçœ‹å“ªäº›æ•°æ®æ˜¯è¢«åˆ é™¤çš„äº†ã€‚<br>2. ä»£ç å¦‚ä¸‹ï¼Œå°†åŸæ¥çš„items deep cloneä¸€ä»½ï¼Œè¿™æ ·å°±åˆ‡æ–­äº†ä¸åŸæ¥itemsçš„è”ç³»ã€‚<br>  public class ShoppingCart { <br>    &#47;&#47; ...çœç•¥å…¶ä»–ä»£ç ... <br>    public List&lt;ShoppingCartItem&gt; getItems() {<br>      List&lt;ShoppingCartItem&gt; tmpShoppingCartItems = new ArrayList&lt;&gt;();<br>      tmpShoppingCartItems.addAll(this.items);<br>      return Collections.unmodifiableList(tmpShoppingCartItems); <br>    }<br>  } 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            å”é¾™  2020-02-19 10:43:31
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            ä¹‹å‰å¬è¯´ï¼Œå¯èƒ½ä½ åœ¨ä¸ç»æ„é—´å·²ç»ç”¨è¿‡ä¸€äº›è®¾è®¡æ¨¡å¼äº†ï¼Œä»Šå¤©ç»ˆäºæœ‰è¿™ç§æ„Ÿè§‰äº†ï¼Œç¡®å®å¯¹åŸå‹æ¨¡å¼æœ‰è¿‡ä¸€äº›ç®€å•åº”ç”¨ã€‚ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            test  2020-02-19 09:29:17
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            1.ç”¨ä¸€ä¸ªæ ‡è®°ä½è¡¨ç¤ºè¢«åˆ é™¤<br>2.è¿”å›ä¸€ä¸ªæ·±æ‹·è´å¯¹è±¡ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            Panmax  2020-02-19 09:21:56
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            æ–‡ç« ä¸­çš„æœ€åä¸€ç§æ–¹æ¡ˆï¼šã€Œå…ˆé‡‡ç”¨æµ…æ‹·è´çš„æ–¹å¼åˆ›å»º newKeywordsã€‚å¯¹äºéœ€è¦æ›´æ–°çš„ SearchWord å¯¹è±¡ï¼Œå†ä½¿ç”¨æ·±åº¦æ‹·è´çš„æ–¹å¼åˆ›å»ºä¸€ä»½æ–°çš„å¯¹è±¡ï¼Œæ›¿æ¢ newKeywords ä¸­çš„è€å¯¹è±¡ã€‚ã€<br><br>æ˜¯ä¸æ˜¯å¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ç§ Copy On Write çš„ä¼˜åŒ–ç­–ç•¥ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            pedro  2020-02-19 09:21:12
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            æƒ³åˆ°äº†linuxè¿›ç¨‹çš„å…‹éš†ï¼Œc++çš„æ‹·è´æ„é€ å‡½æ•°éƒ½æ˜¯ä¸€ç§åŸå‹æ¨¡å¼çš„ä½¿ç”¨ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            Summer  ç©ºåŸ  2020-02-19 08:39:14
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            1ï¼Œåˆ é™¤keyå¯¹äºcloneçš„å¯¹è±¡è€Œè¨€ï¼Œä¸ä¼šå½±å“ä¹‹å‰çš„å¯¹è±¡ï¼Œæ‰€ä»¥å®ç°åº”è¯¥ä¸éœ€è¦å˜åŒ–å§<br>2ï¼Œreturn new ArrayList&lt;&gt;(this.items); 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            Jeff.Smile  2020-02-19 00:10:25
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            æ²™å‘ 
        </div>
        
    </div>
</li>
            </ul>
</div>
</body>
</html>
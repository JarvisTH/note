## 一、数据准备

```sql
CREATE TABLE `employee` (
  `employee_id` bigint NOT NULL,
  `employee_name` varchar(100) NOT NULL,
  `age` int NOT NULL,
  `gender` varchar(10) NOT NULL,
  `create_time` datetime NOT NULL,
  PRIMARY KEY (`employee_id`)
) 
```



```sql
DELIMITER //
CREATE PROCEDURE insert_data()
BEGIN
	DECLARE counter INT DEFAULT 0;
	DECLARE gender VARCHAR(10);
	
	WHILE counter < 1000000 DO
		if counter % 2 = 0 then
			set gender = '男';
		ELSE
			set gender = '女';
		END if;
		insert INTO employee (employee_id, employee_name, age, gender, create_time) VALUES
			(counter, CONCAT('Name_',counter,FLOOR(RAND() * 100),gender,NOW());
		set counter = counter + 1;
END WHILE;
END //
DELIMITER ;

call insert_data();
```

## 二、思路

![image-20240331234144981](../../../../picbed/store/picbed/img/image-20240331234144981.png)

## 三、项目准备

```xml
		<dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
        <dependency>
            <groupId>com.mysql</groupId>
            <artifactId>mysql-connector-j</artifactId>
        </dependency>
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
        </dependency>
        <dependency>
            <groupId>com.alibaba</groupId>
            <artifactId>druid-spring-boot-starter</artifactId>
            <version>1.2.18</version>
        </dependency>
        <dependency>
            <groupId>com.baomidou</groupId>
            <artifactId>mybatis-plus-spring-boot3-starter</artifactId>
            <exclusions>
                <exclusion>
                    <groupId>org.springframework.boot</groupId>
                    <artifactId>spring-boot-starter-jdbc</artifactId>
                </exclusion>
            </exclusions>
            <version>3.5.5</version>
        </dependency>
        <dependency>
            <groupId>cn.hutool</groupId>
            <artifactId>hutool-all</artifactId>
            <version>5.8.22</version>
        </dependency>
        <dependency>
            <groupId>com.alibaba</groupId>
            <artifactId>easyexcel</artifactId>
            <version>3.3.4</version>
        </dependency>
```

## 四、导出

### 1.全表写入一个sheet



### 2.全表写入多个sheet



### 3.数据分页查询写入多个sheet



### 4.多线程分页查询写入每个sheet

